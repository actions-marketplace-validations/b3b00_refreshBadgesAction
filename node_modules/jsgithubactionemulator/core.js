const process = require("process");
const github = require("@actions/github");
const ghcore = require("@actions/core");
const fs = require('fs');
try {
  console.log(process.cwd(),fs.existsSync(".env"));
  if (fs.existsSync(".env")) {
    console.log("found .env");
    const dotenv = require("dotenv").config();
    console.log(dotenv);
    console.log(process.env);
  }
  else{
    console.log("no .env file");
  }
} catch (e) {
  console.log(e);
  // avoid error if .env file is not found
}

const core = {
  getInput: (key) => {
    return process.env["GHA_INPUT_" + key];
  },

  setFailed: (msg) => {
    console.log("!!!!!!!!! " + msg);
    process.exit(1);
  },
  setOutput: (name, value) => {
    console.log(`******* ${name} = ${value}`);
  },
};

let coreObject = null;
if (process.env["GHA_EMULATE"]) {
  console.log("!!!!!!!!!!!!!!!!!!! emulating gh actions !!!!!!!!!!!!!!!!!!!!!");
  coreObject = core;
} else {
  coreObject = ghcore;
}
exports.getInput = coreObject.getInput;
exports.setFailed = coreObject.setFailed;
exports.setOutput = coreObject.setOutput;
exports.getInput = coreObject.getInput;
